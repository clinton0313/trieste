
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>trieste.models.gpflow &#8212; trieste 0.10.0 documentation</title>
    
    <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    
    <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="trieste.models.gpflow.builders" href="builders/index.html" />
    <link rel="prev" title="trieste.models" href="../index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../index.html">
  <img src="../../../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../index.html">
  Trieste
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../tutorials.html">
  Tutorials
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/secondmind-labs/trieste" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../acquisition/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.acquisition
    </span>
   </code>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../acquisition/function/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.acquisition.function
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/function/active_learning/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.function.active_learning
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/function/continuous_thompson_sampling/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.function.continuous_thompson_sampling
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/function/entropy/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.function.entropy
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/function/function/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.function.function
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/function/greedy_batch/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.function.greedy_batch
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/function/multi_objective/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.function.multi_objective
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../acquisition/multi_objective/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.acquisition.multi_objective
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/multi_objective/dominance/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.multi_objective.dominance
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/multi_objective/pareto/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.multi_objective.pareto
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../acquisition/multi_objective/partition/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.acquisition.multi_objective.partition
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../acquisition/interface/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.acquisition.interface
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../acquisition/optimizer/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.acquisition.optimizer
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../acquisition/rule/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.acquisition.rule
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../acquisition/sampler/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.acquisition.sampler
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.models
    </span>
   </code>
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active has-children">
    <a class="current reference internal" href="#">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.models.gpflow
      </span>
     </code>
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="builders/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.gpflow.builders
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="optimizer/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.gpflow.optimizer
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="sampler/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.gpflow.sampler
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../gpflux/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.models.gpflux
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../gpflux/architectures/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.gpflux.architectures
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../keras/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.models.keras
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../keras/architectures/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.keras.architectures
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../keras/builders/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.keras.builders
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../keras/sampler/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         trieste.models.keras.sampler
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../config/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.models.config
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../optimizer/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.models.optimizer
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../objectives/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.objectives
    </span>
   </code>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../objectives/multi_objectives/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.objectives.multi_objectives
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../objectives/single_objectives/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.objectives.single_objectives
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../objectives/utils/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       trieste.objectives.utils
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../utils/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.utils
    </span>
   </code>
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ask_tell_optimization/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.ask_tell_optimization
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../bayesian_optimizer/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.bayesian_optimizer
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.data
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../logging/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.logging
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../observer/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.observer
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../space/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.space
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../types/index.html">
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     trieste.types
    </span>
   </code>
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#package-contents">
   Package Contents
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.build_gpr">
     build_gpr
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.build_sgpr">
     build_sgpr
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.build_svgp">
     build_svgp
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.build_vgp_classifier">
     build_vgp_classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor">
     GPflowPredictor
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.optimizer">
       optimizer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.predict_joint">
       predict_joint
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.sample">
       sample
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.get_kernel">
       get_kernel
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.get_observation_noise">
       get_observation_noise
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.log">
       log
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GPflowPredictor.reparam_sampler">
       reparam_sampler
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression">
     GaussianProcessRegression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.covariance_between_points">
       covariance_between_points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.find_best_model_initialization">
       find_best_model_initialization
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.trajectory_sampler">
       trajectory_sampler
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.get_internal_data">
       get_internal_data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_f">
       conditional_predict_f
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_joint">
       conditional_predict_joint
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_f_sample">
       conditional_predict_f_sample
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_y">
       conditional_predict_y
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.SparseVariational">
     SparseVariational
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.SparseVariational.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.SparseVariational.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.SparseVariational.covariance_between_points">
       covariance_between_points
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.VariationalGaussianProcess">
     VariationalGaussianProcess
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.VariationalGaussianProcess.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.VariationalGaussianProcess.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.VariationalGaussianProcess.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.VariationalGaussianProcess.get_internal_data">
       get_internal_data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.VariationalGaussianProcess.covariance_between_points">
       covariance_between_points
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.BatchReparametrizationSampler">
     BatchReparametrizationSampler
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.BatchReparametrizationSampler.sample">
       sample
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.IndependentReparametrizationSampler">
     IndependentReparametrizationSampler
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.IndependentReparametrizationSampler.sample">
       sample
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler">
     RandomFourierFeatureTrajectorySampler
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler._prepare_theta_posterior_in_design_space">
       _prepare_theta_posterior_in_design_space
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler._prepare_theta_posterior_in_gram_space">
       _prepare_theta_posterior_in_gram_space
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.get_trajectory">
       get_trajectory
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.update_trajectory">
       update_trajectory
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.resample_trajectory">
       resample_trajectory
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.fourier_feature_trajectory">
     fourier_feature_trajectory
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.fourier_feature_trajectory.__call__">
       __call__
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.fourier_feature_trajectory.resample">
       resample
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.fourier_feature_trajectory.update">
       update
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.check_optimizer">
     check_optimizer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.randomize_hyperparameters">
     randomize_hyperparameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.squeeze_hyperparameters">
     squeeze_hyperparameters
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-trieste.models.gpflow">
<span id="trieste-models-gpflow"></span><h1><a class="reference internal" href="#module-trieste.models.gpflow" title="trieste.models.gpflow"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trieste.models.gpflow</span></code></a><a class="headerlink" href="#module-trieste.models.gpflow" title="Permalink to this headline">¶</a></h1>
<p>This package contains the primary interface for Gaussian process models. It also contains a
number of <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrappers for GPflow-based models.</p>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="builders/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trieste.models.gpflow.builders</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trieste.models.gpflow.optimizer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trieste.models.gpflow.sampler</span></code></a></li>
</ul>
</div>
</div>
<div class="section" id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="trieste.models.gpflow.build_gpr">
<code class="sig-name descname"><span class="pre">build_gpr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_space</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../space/index.html#trieste.space.SearchSpace" title="trieste.space.SearchSpace"><span class="pre">trieste.space.SearchSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_priors</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_likelihood</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.GPR</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/builders.html#build_gpr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.build_gpr" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <code class="xref py py-class docutils literal notranslate"><span class="pre">GPR</span></code> model with sensible initial parameters and
priors. We use <code class="xref py py-class docutils literal notranslate"><span class="pre">Matern52</span></code> kernel and
<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> mean function in the model. We found the default
configuration used here to work well in most situation, but it should not be taken as a
universally good solution.</p>
<p>We set priors for kernel hyperparameters by default in order to stabilize model fitting. We
found the priors below to be highly effective for objective functions defined over the unit
hypercube. They do seem to work for other search space sizes, but we advise caution when using
them in such search spaces. Using priors allows for using maximum a posteriori estimate of
these kernel parameters during model fitting.</p>
<p>Note that although we scale parameters as a function of the size of the search space, ideally
inputs should be normalised to the unit hypercube before building a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataset from the initial design, used for estimating the variance of observations.</p></li>
<li><p><strong>search_space</strong> – Search space for performing Bayesian optimization, used for scaling the
parameters.</p></li>
<li><p><strong>kernel_priors</strong> – If set to <cite>True</cite> (default) priors are set for kernel parameters (variance
and lengthscale).</p></li>
<li><p><strong>likelihood_variance</strong> – Likelihood (noise) variance parameter can be optionally set to a
certain value. If left unspecified (default), the noise variance is set to maintain the
signal to noise ratio of value given by <code class="docutils literal notranslate"><span class="pre">SIGNAL_NOISE_RATIO_LIKELIHOOD</span></code>, where signal
variance in the kernel is set to the empirical variance.</p></li>
<li><p><strong>trainable_likelihood</strong> – If set to <cite>True</cite> Gaussian likelihood parameter is set to
non-trainable. By default set to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">GPR</span></code> model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trieste.models.gpflow.build_sgpr">
<code class="sig-name descname"><span class="pre">build_sgpr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_space</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../space/index.html#trieste.space.SearchSpace" title="trieste.space.SearchSpace"><span class="pre">trieste.space.SearchSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_priors</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_likelihood</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_inducing_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_inducing_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.SGPR</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/builders.html#build_sgpr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.build_sgpr" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <code class="xref py py-class docutils literal notranslate"><span class="pre">SGPR</span></code> model with sensible initial parameters and
priors. We use <code class="xref py py-class docutils literal notranslate"><span class="pre">Matern52</span></code> kernel and
<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> mean function in the model. We found the default
configuration used here to work well in most situation, but it should not be taken as a
universally good solution.</p>
<p>We set priors for kernel hyperparameters by default in order to stabilize model fitting. We
found the priors below to be highly effective for objective functions defined over the unit
hypercube. They do seem to work for other search space sizes, but we advise caution when using
them in such search spaces. Using priors allows for using maximum a posteriori estimate of
these kernel parameters during model fitting.</p>
<p>For performance reasons number of inducing points should not be changed during Bayesian
optimization. Hence, even if the initial dataset is smaller, we advise setting this to a higher
number. By default inducing points are set to Sobol samples for the continuous search space,
and simple random samples for discrete or mixed search spaces. This carries
the risk that optimization gets stuck if they are not trainable, which calls for adaptive
inducing point selection during the optimization. This functionality will be added to Trieste
in future.</p>
<p>Note that although we scale parameters as a function of the size of the search space, ideally
inputs should be normalised to the unit hypercube before building a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataset from the initial design, used for estimating the variance of observations.</p></li>
<li><p><strong>search_space</strong> – Search space for performing Bayesian optimization, used for scaling the
parameters.</p></li>
<li><p><strong>kernel_priors</strong> – If set to <cite>True</cite> (default) priors are set for kernel parameters (variance
and lengthscale).</p></li>
<li><p><strong>likelihood_variance</strong> – Likelihood (noise) variance parameter can be optionally set to a
certain value. If left unspecified (default), the noise variance is set to maintain the
signal to noise ratio of value given by <code class="docutils literal notranslate"><span class="pre">SIGNAL_NOISE_RATIO_LIKELIHOOD</span></code>, where signal
variance in the kernel is set to the empirical variance.</p></li>
<li><p><strong>trainable_likelihood</strong> – If set to <cite>True</cite> Gaussian likelihood parameter is set to
be trainable. By default set to <cite>False</cite>.</p></li>
<li><p><strong>num_inducing_points</strong> – The number of inducing points can be optionally set to a
certain value. If left unspecified (default), this number is set to either
<code class="docutils literal notranslate"><span class="pre">NUM_INDUCING_POINTS_PER_DIM``*dimensionality</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">search</span> <span class="pre">space</span> <span class="pre">or</span> <span class="pre">value</span> <span class="pre">given</span> <span class="pre">by</span>
<span class="pre">``MAX_NUM_INDUCING_POINTS</span></code>, whichever is smaller.</p></li>
<li><p><strong>trainable_inducing_points</strong> – If set to <cite>True</cite> inducing points will be set to
be trainable. This option should be used with caution. By default set to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">SGPR</span></code> model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trieste.models.gpflow.build_svgp">
<code class="sig-name descname"><span class="pre">build_svgp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_space</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../space/index.html#trieste.space.SearchSpace" title="trieste.space.SearchSpace"><span class="pre">trieste.space.SearchSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_priors</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_likelihood</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_inducing_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_inducing_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.SVGP</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/builders.html#build_svgp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.build_svgp" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <code class="xref py py-class docutils literal notranslate"><span class="pre">SVGP</span></code> model with sensible initial parameters and
priors. Both regression and binary classification models are
available. We use <code class="xref py py-class docutils literal notranslate"><span class="pre">Matern52</span></code> kernel and
<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> mean function in the model. We found the default
configuration used here to work well in most situation, but it should not be taken as a
universally good solution.</p>
<p>We set priors for kernel hyperparameters by default in order to stabilize model fitting. We
found the priors below to be highly effective for objective functions defined over the unit
hypercube. They do seem to work for other search space sizes, but we advise caution when using
them in such search spaces. Using priors allows for using maximum a posteriori estimate of
these kernel parameters during model fitting.</p>
<p>For performance reasons number of inducing points should not be changed during Bayesian
optimization. Hence, even if the initial dataset is smaller, we advise setting this to a higher
number. By default inducing points are set to Sobol samples for the continuous search space,
and simple random samples for discrete or mixed search spaces. This carries
the risk that optimization gets stuck if they are not trainable, which calls for adaptive
inducing point selection during the optimization. This functionality will be added to Trieste
in future.</p>
<p>Note that although we scale parameters as a function of the size of the search space, ideally
inputs should be normalised to the unit hypercube before building a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataset from the initial design, used for estimating the variance of observations.</p></li>
<li><p><strong>search_space</strong> – Search space for performing Bayesian optimization, used for scaling the
parameters.</p></li>
<li><p><strong>classification</strong> – If a classification model is needed, this should be set to <cite>True</cite>, in
which case a Bernoulli likelihood will be used. If a regression model is required, this
should be set to <cite>False</cite> (default), in which case a Gaussian likelihood is used.</p></li>
<li><p><strong>kernel_priors</strong> – If set to <cite>True</cite> (default) priors are set for kernel parameters (variance
and lengthscale).</p></li>
<li><p><strong>likelihood_variance</strong> – Likelihood (noise) variance parameter can be optionally set to a
certain value. If left unspecified (default), the noise variance is set to maintain the
signal to noise ratio of value given by <code class="docutils literal notranslate"><span class="pre">SIGNAL_NOISE_RATIO_LIKELIHOOD</span></code>, where signal
variance in the kernel is set to the empirical variance. This argument is ignored in the
classification case.</p></li>
<li><p><strong>trainable_likelihood</strong> – If set to <cite>True</cite> likelihood parameter is set to
be trainable. By default set to <cite>False</cite>. This argument is ignored in the classification
case.</p></li>
<li><p><strong>num_inducing_points</strong> – The number of inducing points can be optionally set to a
certain value. If left unspecified (default), this number is set to either
<code class="docutils literal notranslate"><span class="pre">NUM_INDUCING_POINTS_PER_DIM``*dimensionality</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">search</span> <span class="pre">space</span> <span class="pre">or</span> <span class="pre">value</span> <span class="pre">given</span> <span class="pre">by</span>
<span class="pre">``MAX_NUM_INDUCING_POINTS</span></code>, whichever is smaller.</p></li>
<li><p><strong>trainable_inducing_points</strong> – If set to <cite>True</cite> inducing points will be set to
be trainable. This option should be used with caution. By default set to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">SVGP</span></code> model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trieste.models.gpflow.build_vgp_classifier">
<code class="sig-name descname"><span class="pre">build_vgp_classifier</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_space</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../space/index.html#trieste.space.SearchSpace" title="trieste.space.SearchSpace"><span class="pre">trieste.space.SearchSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_priors</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_free</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.VGP</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/builders.html#build_vgp_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.build_vgp_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code> binary classification model with sensible initial
parameters and priors. We use <code class="xref py py-class docutils literal notranslate"><span class="pre">Matern52</span></code> kernel and
<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> mean function in the model. We found the default
configuration used here to work well in most situation, but it should not be taken as a
universally good solution.</p>
<p>We set priors for kernel hyperparameters by default in order to stabilize model fitting. We
found the priors below to be highly effective for objective functions defined over the unit
hypercube. They do seem to work for other search space sizes, but we advise caution when using
them in such search spaces. Using priors allows for using maximum a posteriori estimate of
these kernel parameters during model fitting. In the <code class="docutils literal notranslate"><span class="pre">noise_free</span></code> case we do not use prior
for the kernel variance parameters.</p>
<p>Note that although we scale parameters as a function of the size of the search space, ideally
inputs should be normalised to the unit hypercube before building a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataset from the initial design, used for estimating the variance of observations.</p></li>
<li><p><strong>search_space</strong> – Search space for performing Bayesian optimization, used for scaling the
parameters.</p></li>
<li><p><strong>kernel_priors</strong> – If set to <cite>True</cite> (default) priors are set for kernel parameters (variance
and lengthscale). In the <code class="docutils literal notranslate"><span class="pre">noise_free</span></code> case kernel variance prior is not set.</p></li>
<li><p><strong>noise_free</strong> – If  there is a prior information that the classification problem is a
deterministic one, this should be set to <cite>True</cite> and kernel variance will be fixed to a
higher default value <code class="docutils literal notranslate"><span class="pre">CLASSIFICATION_KERNEL_VARIANCE_NOISE_FREE</span></code> leading to sharper
classification boundary. In this case prior for the kernel variance parameter is also not
set. By default set to <cite>False</cite>.</p></li>
<li><p><strong>kernel_variance</strong> – Kernel variance parameter can be optionally set to a
certain value. If left unspecified (default), the kernel variance is set to
<code class="docutils literal notranslate"><span class="pre">CLASSIFICATION_KERNEL_VARIANCE_NOISE_FREE</span></code> in the <code class="docutils literal notranslate"><span class="pre">noise_free</span></code> case and to
<code class="docutils literal notranslate"><span class="pre">CLASSIFICATION_KERNEL_VARIANCE</span></code> otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code> model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.GPflowPredictor">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">GPflowPredictor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/interface.html#GPflowPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsPredictJoint" title="trieste.models.interfaces.SupportsPredictJoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsPredictJoint</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsGetKernel" title="trieste.models.interfaces.SupportsGetKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetKernel</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsGetObservationNoise" title="trieste.models.interfaces.SupportsGetObservationNoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetObservationNoise</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.HasReparamSampler" title="trieste.models.interfaces.HasReparamSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.HasReparamSampler</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>A trainable wrapper for a GPflow Gaussian process model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.optimizer">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">optimizer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><span class="pre">trieste.models.optimizer.Optimizer</span></a><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>The optimizer with which to train the model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.GPModel</span><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.predict">
<code class="sig-name descname"><span class="pre">predict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>.</p>
<p>This is essentially a convenience method for <a class="reference internal" href="#trieste.models.gpflow.GPflowPredictor.predict_joint" title="trieste.models.gpflow.GPflowPredictor.predict_joint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_joint()</span></code></a>, where non-event
dimensions of <code class="docutils literal notranslate"><span class="pre">query_points</span></code> are all interpreted as broadcasting dimensions instead of
batch dimensions, and the covariance is squeezed to remove redundant nesting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean and
variance will both have shape […] + E.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.predict_joint">
<code class="sig-name descname"><span class="pre">predict_joint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.predict_joint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, B, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and covariance of the joint marginal distribution at each batch of points
in <code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean will
have shape […, B] + E, and the covariance shape […] + E + [B, B].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">num_samples</span></code> samples from the independent marginal distributions at
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – The points at which to sample, with shape […, N, D].</p></li>
<li><p><strong>num_samples</strong> – The number of samples at each point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The samples. For a predictive distribution with event shape E, this has shape
[…, S, N] + E, where S is the number of samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.predict_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code> for the observations, including noise contributions.</p>
<p>Note that this is not supported by all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean and
variance will both have shape […] + E.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.get_kernel">
<code class="sig-name descname"><span class="pre">get_kernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.kernels.Kernel</span><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.get_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the kernel of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The kernel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.get_observation_noise">
<code class="sig-name descname"><span class="pre">get_observation_noise</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.get_observation_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance of observation noise for homoscedastic likelihoods.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The observation noise.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.10)"><strong>NotImplementedError</strong></a> – If the model does not have a homoscedastic likelihood.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize the model with the specified <cite>dataset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to optimize the <cite>model</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.log">
<code class="sig-name descname"><span class="pre">log</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Log model-specific information at a given optimization step.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GPflowPredictor.reparam_sampler">
<code class="sig-name descname"><span class="pre">reparam_sampler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.ReparametrizationSampler" title="trieste.models.interfaces.ReparametrizationSampler"><span class="pre">trieste.models.interfaces.ReparametrizationSampler</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.GPflowPredictor" title="trieste.models.gpflow.GPflowPredictor"><span class="pre">GPflowPredictor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GPflowPredictor.reparam_sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a reparametrization sampler providing <cite>num_samples</cite> samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reparametrization sampler.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.GaussianProcessRegression">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">GaussianProcessRegression</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">GPR</span> <span class="p"><span class="pre">|</span></span> <span class="pre">SGPR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_kernel_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rff_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.FastUpdateModel" title="trieste.models.interfaces.FastUpdateModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.FastUpdateModel</span></code></a>, <a class="reference internal" href="interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsInternalData" title="trieste.models.interfaces.SupportsInternalData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsInternalData</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.HasTrajectorySampler" title="trieste.models.interfaces.HasTrajectorySampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.HasTrajectorySampler</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">GPR</span></code>
or <code class="xref py py-class docutils literal notranslate"><span class="pre">SGPR</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The GPflow model to wrap.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>.</p></li>
<li><p><strong>num_kernel_samples</strong> – Number of randomly sampled kernels (for each kernel parameter) to
evaluate before beginning model optimization. Therefore, for a kernel with <cite>p</cite>
(vector-valued) parameters, we evaluate <cite>p * num_kernel_samples</cite> kernels.</p></li>
<li><p><strong>num_rff_features</strong> – The number of random Foruier features used to approximate the
kernel when calling <a class="reference internal" href="#trieste.models.gpflow.GaussianProcessRegression.trajectory_sampler" title="trieste.models.gpflow.GaussianProcessRegression.trajectory_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trajectory_sampler()</span></code></a>. We use a default of 1000 as it
typically perfoms well for a wide range of kernels. Note that very smooth
kernels (e.g. RBF) can be well-approximated with fewer features.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">GPR</span> <span class="p"><span class="pre">|</span></span> <span class="pre">SGPR</span><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to update the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.covariance_between_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<div class="math notranslate nohighlight">
\[\Sigma_{12} = K_{12} - K_{x1}(K_{xx} + \sigma^2 I)^{-1}K_{x2}\]</div>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, N, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [M, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, N, M]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize the model with the specified <cite>dataset</cite>.</p>
<p>For <a class="reference internal" href="#trieste.models.gpflow.GaussianProcessRegression" title="trieste.models.gpflow.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, we (optionally) try multiple randomly sampled
kernel parameter configurations as well as the configuration specified when initializing
the kernel. The best configuration is used as the starting point for model optimization.</p>
<p>For trainable parameters constrained to lie in a finite interval (through a sigmoid
bijector), we begin model optimization from the best of a random sample from these
parameters’ acceptable domains.</p>
<p>For trainable parameters without constraints but with priors, we begin model optimization
from the best of a random sample from these parameters’ priors.</p>
<p>For trainable parameters with neither priors nor constraints, we begin optimization from
their initial values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to optimize the <cite>model</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.find_best_model_initialization">
<code class="sig-name descname"><span class="pre">find_best_model_initialization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_kernel_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.find_best_model_initialization" title="Permalink to this definition">¶</a></dt>
<dd><p>Test <cite>num_kernel_samples</cite> models with sampled kernel parameters. The model’s kernel
parameters are then set to the sample achieving maximal likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_kernel_samples</strong> – Number of randomly sampled kernels to evaluate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.trajectory_sampler">
<code class="sig-name descname"><span class="pre">trajectory_sampler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectorySampler" title="trieste.models.interfaces.TrajectorySampler"><span class="pre">trieste.models.interfaces.TrajectorySampler</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.GaussianProcessRegression" title="trieste.models.gpflow.GaussianProcessRegression"><span class="pre">GaussianProcessRegression</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.trajectory_sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a trajectory sampler. For <a class="reference internal" href="#trieste.models.gpflow.GaussianProcessRegression" title="trieste.models.gpflow.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, we build
trajectories using a random Fourier feature approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The trajectory sampler.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.get_internal_data">
<code class="sig-name descname"><span class="pre">get_internal_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.get_internal_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the model’s training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The model’s training data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.conditional_predict_f">
<code class="sig-name descname"><span class="pre">conditional_predict_f</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the marginal GP distribution at query_points conditioned on both the model
and some additional data, using exact formula. See <span id="id1">[<a class="reference internal" href="../../index.html#id31" title="Clément Chevalier, David Ginsbourger, and Xavier Emery. Corrected kriging update formulae for batch-sequential data assimilation. In Mathematics of Planet Earth, pages 119–122. Springer, 2014.">CGE14</a>]</span>
(eqs. 8-10) for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean_qp_new: predictive mean at query_points, with shape […, M, L],
and var_qp_new: predictive variance at query_points, with shape […, M, L]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.conditional_predict_joint">
<code class="sig-name descname"><span class="pre">conditional_predict_joint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_joint" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts the joint GP distribution at query_points conditioned on both the model
and some additional data, using exact formula. See <span id="id2">[<a class="reference internal" href="../../index.html#id31" title="Clément Chevalier, David Ginsbourger, and Xavier Emery. Corrected kriging update formulae for batch-sequential data assimilation. In Mathematics of Planet Earth, pages 119–122. Springer, 2014.">CGE14</a>]</span>
(eqs. 8-10) for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean_qp_new: predictive mean at query_points, with shape […, M, L],
and cov_qp_new: predictive covariance between query_points, with shape
[…, L, M, M]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.conditional_predict_f_sample">
<code class="sig-name descname"><span class="pre">conditional_predict_f_sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_f_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates samples of the GP at query_points conditioned on both the model
and some additional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
<li><p><strong>num_samples</strong> – number of samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>samples of f at query points, with shape […, num_samples, M, L]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.GaussianProcessRegression.conditional_predict_y">
<code class="sig-name descname"><span class="pre">conditional_predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#trieste.models.gpflow.GaussianProcessRegression.conditional_predict_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates samples of y from the GP at query_points conditioned on both the model
and some additional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictive variance at query_points, with shape […, M, L],
and predictive variance at query_points, with shape […, M, L]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.SparseVariational">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SparseVariational</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.models.SVGP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/models.html#SparseVariational"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.SparseVariational" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">SVGP</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The underlying GPflow sparse variational model.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.BatchOptimizer" title="trieste.models.optimizer.BatchOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Adam</span></code> with
batch size 100.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.SparseVariational.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.SVGP</span><a class="headerlink" href="#trieste.models.gpflow.SparseVariational.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.SparseVariational.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.SparseVariational.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to update the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.SparseVariational.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.SparseVariational.covariance_between_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, A, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [B, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, A, B]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.VariationalGaussianProcess">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">VariationalGaussianProcess</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.models.VGP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_natgrads</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natgrad_gamma</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.VariationalGaussianProcess" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsInternalData" title="trieste.models.interfaces.SupportsInternalData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsInternalData</span></code></a>, <a class="reference internal" href="interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code>.</p>
<p>A Variational Gaussian Process (VGP) approximates the posterior of a GP
using the multivariate Gaussian closest to the posterior of the GP by minimizing the
KL divergence between approximated and exact posteriors. See <span id="id3">[<a class="reference internal" href="../../index.html#id20" title="Manfred Opper and Cédric Archambeau. The variational gaussian approximation revisited. Neural computation, 2009.">OA09</a>]</span>
for details.</p>
<p>The VGP provides (approximate) GP modelling under non-Gaussian likelihoods, for example
when fitting a classification model over binary data.</p>
<p>A whitened representation and (optional) natural gradient steps are used to aid
model optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code>.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>.</p></li>
<li><p><strong>use_natgrads</strong> – If True then alternate model optimization steps with natural
gradient updates. Note that natural gradients requires
a <a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.BatchOptimizer" title="trieste.models.optimizer.BatchOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code></a> wrapper with
<code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code> optimizer.</p></li>
</ul>
</dd>
<dt class="field-even">Natgrad_gamma</dt>
<dd class="field-even"><p>Gamma parameter for the natural gradient optimizer.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a><strong> (or </strong><strong>InvalidArgumentError</strong><strong>)</strong> – If <code class="docutils literal notranslate"><span class="pre">model</span></code>’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">q_sqrt</span></code> is not rank 3
or if attempting to combine natural gradients with a <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>
optimizer.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.VariationalGaussianProcess.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">gpflow.models.VGP</span><a class="headerlink" href="#trieste.models.gpflow.VariationalGaussianProcess.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.VariationalGaussianProcess.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">DEFAULTS.JITTER</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.VariationalGaussianProcess.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – The data with which to update the model.</p></li>
<li><p><strong>jitter</strong> – The size of the jitter to use when stabilizing the Cholesky decomposition of
the covariance matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.VariationalGaussianProcess.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.VariationalGaussianProcess.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#trieste.models.gpflow.VariationalGaussianProcess" title="trieste.models.gpflow.VariationalGaussianProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalGaussianProcess</span></code></a> has a custom <cite>optimize</cite> method that (optionally) permits
alternating between standard optimization steps (for kernel parameters) and natural gradient
steps for the variational parameters (<cite>q_mu</cite> and <cite>q_sqrt</cite>). See <span id="id4">[<a class="reference internal" href="../../index.html#id21" title="Hugh Salimbeni, Stefanos Eleftheriadis, and James Hensman. Natural gradients in practice: non-conjugate variational inference in gaussian process models. International Conference on Artificial Intelligence and Statistics, 2018.">SEH18</a>]</span>
for details. Using natural gradients can dramatically speed up model fitting, especially for
ill-conditioned posteriors.</p>
<p>If using natural gradients, our optimizer inherits the mini-batch behavior and number
of optimization steps as the base optimizer specified when initializing
the <a class="reference internal" href="#trieste.models.gpflow.VariationalGaussianProcess" title="trieste.models.gpflow.VariationalGaussianProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalGaussianProcess</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.VariationalGaussianProcess.get_internal_data">
<code class="sig-name descname"><span class="pre">get_internal_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a><a class="headerlink" href="#trieste.models.gpflow.VariationalGaussianProcess.get_internal_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the model’s training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The model’s training data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.VariationalGaussianProcess.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.VariationalGaussianProcess.covariance_between_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, A, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [B, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, A, B]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.BatchReparametrizationSampler">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">BatchReparametrizationSampler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsPredictJoint" title="trieste.models.interfaces.SupportsPredictJoint"><span class="pre">trieste.models.interfaces.SupportsPredictJoint</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/sampler.html#BatchReparametrizationSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.BatchReparametrizationSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.ReparametrizationSampler" title="trieste.models.interfaces.ReparametrizationSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.ReparametrizationSampler</span></code></a>[<a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.SupportsPredictJoint" title="trieste.models.interfaces.SupportsPredictJoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsPredictJoint</span></code></a>]</p>
<p>This sampler employs the <em>reparameterization trick</em> to approximate batches of samples from a
<code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code>‘s predictive joint distribution as</p>
<div class="math notranslate nohighlight">
\[x \mapsto \mu(x) + \epsilon L(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the Cholesky factor s.t. <span class="math notranslate nohighlight">\(LL^T\)</span> is the covariance, and
<span class="math notranslate nohighlight">\(\epsilon \sim \mathcal N (0, 1)\)</span> is constant for a given sampler, thus ensuring samples
form a continuous curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_size</strong> – The number of samples for each batch of points. Must be positive.</p></li>
<li><p><strong>model</strong> – The model to sample from.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a><strong> (or </strong><strong>InvalidArgumentError</strong><strong>)</strong> – If <code class="docutils literal notranslate"><span class="pre">sample_size</span></code> is not positive.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.BatchReparametrizationSampler.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">DEFAULTS.JITTER</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.BatchReparametrizationSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return approximate samples from the <cite>model</cite> specified at <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>. Multiple calls to
<a class="reference internal" href="#trieste.models.gpflow.BatchReparametrizationSampler.sample" title="trieste.models.gpflow.BatchReparametrizationSampler.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>, for any given <a class="reference internal" href="#trieste.models.gpflow.BatchReparametrizationSampler" title="trieste.models.gpflow.BatchReparametrizationSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchReparametrizationSampler</span></code></a> and <code class="docutils literal notranslate"><span class="pre">at</span></code>, will
produce the exact same samples. Calls to <a class="reference internal" href="#trieste.models.gpflow.BatchReparametrizationSampler.sample" title="trieste.models.gpflow.BatchReparametrizationSampler.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> on <em>different</em>
<a class="reference internal" href="#trieste.models.gpflow.BatchReparametrizationSampler" title="trieste.models.gpflow.BatchReparametrizationSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchReparametrizationSampler</span></code></a> instances will produce different samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>at</strong> – Batches of query points at which to sample the predictive distribution, with
shape <cite>[…, B, D]</cite>, for batches of size <cite>B</cite> of points of dimension <cite>D</cite>. Must have a
consistent batch size across all calls to <a class="reference internal" href="#trieste.models.gpflow.BatchReparametrizationSampler.sample" title="trieste.models.gpflow.BatchReparametrizationSampler.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> for any given
<a class="reference internal" href="#trieste.models.gpflow.BatchReparametrizationSampler" title="trieste.models.gpflow.BatchReparametrizationSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchReparametrizationSampler</span></code></a>.</p></li>
<li><p><strong>jitter</strong> – The size of the jitter to use when stabilising the Cholesky decomposition of
the covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The samples, of shape <cite>[…, S, B, L]</cite>, where <cite>S</cite> is the <cite>sample_size</cite>, <cite>B</cite> the
number of points per batch, and <cite>L</cite> the dimension of the model’s predictive
distribution.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a><strong> (or </strong><strong>InvalidArgumentError</strong><strong>)</strong> – If any of the following are true:
- <code class="docutils literal notranslate"><span class="pre">at</span></code> is a scalar.
- The batch size <cite>B</cite> of <code class="docutils literal notranslate"><span class="pre">at</span></code> is not positive.
- The batch size <cite>B</cite> of <code class="docutils literal notranslate"><span class="pre">at</span></code> differs from that of previous calls.
- <code class="docutils literal notranslate"><span class="pre">jitter</span></code> is negative.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.IndependentReparametrizationSampler">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">IndependentReparametrizationSampler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.ProbabilisticModel" title="trieste.models.interfaces.ProbabilisticModel"><span class="pre">trieste.models.interfaces.ProbabilisticModel</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/sampler.html#IndependentReparametrizationSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.IndependentReparametrizationSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.ReparametrizationSampler" title="trieste.models.interfaces.ReparametrizationSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.ReparametrizationSampler</span></code></a>[<a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.ProbabilisticModel" title="trieste.models.interfaces.ProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.ProbabilisticModel</span></code></a>]</p>
<p>This sampler employs the <em>reparameterization trick</em> to approximate samples from a
<code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code>‘s predictive distribution as</p>
<div class="math notranslate nohighlight">
\[x \mapsto \mu(x) + \epsilon \sigma(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon \sim \mathcal N (0, 1)\)</span> is constant for a given sampler, thus ensuring
samples form a continuous curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_size</strong> – The number of samples to take at each point. Must be positive.</p></li>
<li><p><strong>model</strong> – The model to sample from.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a><strong> (or </strong><strong>InvalidArgumentError</strong><strong>)</strong> – If <code class="docutils literal notranslate"><span class="pre">sample_size</span></code> is not positive.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.IndependentReparametrizationSampler.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">DEFAULTS.JITTER</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.IndependentReparametrizationSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return approximate samples from the <cite>model</cite> specified at <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>. Multiple calls to
<a class="reference internal" href="#trieste.models.gpflow.IndependentReparametrizationSampler.sample" title="trieste.models.gpflow.IndependentReparametrizationSampler.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>, for any given <a class="reference internal" href="#trieste.models.gpflow.IndependentReparametrizationSampler" title="trieste.models.gpflow.IndependentReparametrizationSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndependentReparametrizationSampler</span></code></a> and <code class="docutils literal notranslate"><span class="pre">at</span></code>, will
produce the exact same samples. Calls to <a class="reference internal" href="#trieste.models.gpflow.IndependentReparametrizationSampler.sample" title="trieste.models.gpflow.IndependentReparametrizationSampler.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> on <em>different</em>
<a class="reference internal" href="#trieste.models.gpflow.IndependentReparametrizationSampler" title="trieste.models.gpflow.IndependentReparametrizationSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndependentReparametrizationSampler</span></code></a> instances will produce different samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>at</strong> – Where to sample the predictive distribution, with shape <cite>[…, 1, D]</cite>, for points
of dimension <cite>D</cite>.</p></li>
<li><p><strong>jitter</strong> – The size of the jitter to use when stabilising the Cholesky decomposition of
the covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The samples, of shape <cite>[…, S, 1, L]</cite>, where <cite>S</cite> is the <cite>sample_size</cite> and <cite>L</cite> is
the number of latent model dimensions.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a><strong> (or </strong><strong>InvalidArgumentError</strong><strong>)</strong> – If <code class="docutils literal notranslate"><span class="pre">at</span></code> has an invalid shape or <code class="docutils literal notranslate"><span class="pre">jitter</span></code>
is negative.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">RandomFourierFeatureTrajectorySampler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">SupportsGetKernelObservationNoiseInternalData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/sampler.html#RandomFourierFeatureTrajectorySampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectorySampler" title="trieste.models.interfaces.TrajectorySampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrajectorySampler</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">SupportsGetKernelObservationNoiseInternalData</span></code>]</p>
<p>This class builds functions that approximate a trajectory sampled from an underlying Gaussian
process model. For tractibility, the Gaussian process is approximated with a Bayesian
Linear model across a set of features sampled from the Fourier feature decomposition of
the model’s kernel. See <span id="id5">[<a class="reference internal" href="../../index.html#id19" title="JM Hernández-Lobato, MW Hoffman, and Z Ghahramani. Predictive entropy search for efficient global optimization of black-box functions. Advances in Neural Information Processing Systems, 2014.">HernandezLHG14</a>]</span> for details.</p>
<p>Achieving consistency (ensuring that the same sample draw for all evalutions of a particular
trajectory function) for exact sample draws from a GP is prohibitively costly because it scales
cubically with the number of query points. However, finite feature representations can be
evaluated with constant cost regardless of the required number of queries.</p>
<p>In particular, we approximate the Gaussian processes’ posterior samples as the finite feature
approximation</p>
<div class="math notranslate nohighlight">
\[\hat{f}(x) = \sum_{i=1}^m \phi_i(x)\theta_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_i\)</span> are m Fourier features and <span class="math notranslate nohighlight">\(\theta_i\)</span> are
feature weights sampled from a posterior distribution that depends on the feature values at the
model’s datapoints.</p>
<p>Our implementation follows <span id="id6">[<a class="reference internal" href="../../index.html#id19" title="JM Hernández-Lobato, MW Hoffman, and Z Ghahramani. Predictive entropy search for efficient global optimization of black-box functions. Advances in Neural Information Processing Systems, 2014.">HernandezLHG14</a>]</span>, with our calculations
differing slightly depending on properties of the problem. In particular,  we used different
calculation strategies depending on the number of considered features m and the number
of data points n.</p>
<p>If <span class="math notranslate nohighlight">\(m&lt;n\)</span> then we follow Appendix A of <span id="id7">[<a class="reference internal" href="../../index.html#id19" title="JM Hernández-Lobato, MW Hoffman, and Z Ghahramani. Predictive entropy search for efficient global optimization of black-box functions. Advances in Neural Information Processing Systems, 2014.">HernandezLHG14</a>]</span> and calculate the
posterior distribution for <span class="math notranslate nohighlight">\(\theta\)</span> following their Bayesian linear regression motivation,
i.e. the computation revolves around an O(m^3)  inversion of a design matrix.</p>
<p>If <span class="math notranslate nohighlight">\(n&lt;m\)</span> then we use the kernel trick to recast computation to revolve around an O(n^3)
inversion of a gram matrix. As well as being more efficient in early BO
steps (where <span class="math notranslate nohighlight">\(n&lt;m\)</span>), this second computation method allows much larger choices
of m (as required to approximate very flexible kernels).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_size</strong> – The desired number of samples.</p></li>
<li><p><strong>model</strong> – The model to sample from.</p></li>
<li><p><strong>num_features</strong> – The number of features used to approximate the kernel. We use a default
of 1000 as it typically perfoms well for a wide range of kernels. Note that very smooth
kernels (e.g. RBF) can be well-approximated with fewer features.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is empty.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler._prepare_theta_posterior_in_design_space">
<code class="sig-name descname"><span class="pre">_prepare_theta_posterior_in_design_space</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">tensorflow_probability.distributions.MultivariateNormalTriL</span><a class="headerlink" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler._prepare_theta_posterior_in_design_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the posterior of theta (the feature weights) in the design space. This
distribution is a Gaussian</p>
<div class="math notranslate nohighlight">
\[\theta \sim N(D^{-1}\Phi^Ty,D^{-1}\sigma^2)\]</div>
<p>where the [m,m] design matrix <span class="math notranslate nohighlight">\(D=(\Phi^T\Phi + \sigma^2I_m)\)</span> is defined for
the [n,m] matrix of feature evaluations across the training data <span class="math notranslate nohighlight">\(\Phi\)</span>
and observation noise variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler._prepare_theta_posterior_in_gram_space">
<code class="sig-name descname"><span class="pre">_prepare_theta_posterior_in_gram_space</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">tensorflow_probability.distributions.MultivariateNormalTriL</span><a class="headerlink" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler._prepare_theta_posterior_in_gram_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the posterior of theta (the feature weights) in the gram space.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\theta \sim N(\Phi^TG^{-1}y,I_m - \Phi^TG^{-1}\Phi)\]</div>
</div></blockquote>
<p>where the [n,n] gram matrix <span class="math notranslate nohighlight">\(G=(\Phi\Phi^T + \sigma^2I_n)\)</span> is defined for the [n,m]
matrix of feature evaluations across the training data <span class="math notranslate nohighlight">\(\Phi\)</span> and
observation noise variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.get_trajectory">
<code class="sig-name descname"><span class="pre">get_trajectory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectoryFunction" title="trieste.models.interfaces.TrajectoryFunction"><span class="pre">trieste.models.interfaces.TrajectoryFunction</span></a><a class="headerlink" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.get_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an approximate function draw (trajectory) by sampling weights
and evaluating the feature functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A trajectory function representing an approximate trajectory from the Gaussian
process, taking an input of shape <cite>[N, D]</cite> and returning shape <cite>[N, 1]</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.update_trajectory">
<code class="sig-name descname"><span class="pre">update_trajectory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectoryFunction" title="trieste.models.interfaces.TrajectoryFunction"><span class="pre">trieste.models.interfaces.TrajectoryFunction</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectoryFunction" title="trieste.models.interfaces.TrajectoryFunction"><span class="pre">trieste.models.interfaces.TrajectoryFunction</span></a><a class="headerlink" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.update_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently update a <code class="xref py py-const docutils literal notranslate"><span class="pre">TrajectoryFunction</span></code> to reflect an update in its
underlying <code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code> and resample accordingly.</p>
<p>For a <a class="reference internal" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler" title="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomFourierFeatureTrajectorySampler</span></code></a>, updating the sampler
corresponds to resampling the feature functions (taking into account any
changed kernel parameters) and recalculating the weight distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trajectory</strong> – The trajectory function to be resampled.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The new resampled trajectory function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.resample_trajectory">
<code class="sig-name descname"><span class="pre">resample_trajectory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectoryFunction" title="trieste.models.interfaces.TrajectoryFunction"><span class="pre">trieste.models.interfaces.TrajectoryFunction</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectoryFunction" title="trieste.models.interfaces.TrajectoryFunction"><span class="pre">trieste.models.interfaces.TrajectoryFunction</span></a><a class="headerlink" href="#trieste.models.gpflow.RandomFourierFeatureTrajectorySampler.resample_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently resample a <code class="xref py py-const docutils literal notranslate"><span class="pre">TrajectoryFunction</span></code> in-place to avoid function retracing
with every new sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trajectory</strong> – The trajectory function to be resampled.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The new resampled trajectory function.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.fourier_feature_trajectory">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">fourier_feature_trajectory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_functions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflux.layers.basis_functions.fourier_features.RandomFourierFeaturesCosine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_distribution</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow_probability.distributions.MultivariateNormalTriL</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/sampler.html#fourier_feature_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.fourier_feature_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interfaces/index.html#trieste.models.interfaces.TrajectoryFunctionClass" title="trieste.models.interfaces.TrajectoryFunctionClass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrajectoryFunctionClass</span></code></a></p>
<p>An approximate sample from a Gaussian processes’ posterior samples represented as a
finite weighted sum of features.</p>
<p>A trajectory is given by</p>
<div class="math notranslate nohighlight">
\[\hat{f}(x) = \sum_{i=1}^m \phi_i(x)\theta_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_i\)</span> are m feature functions and <span class="math notranslate nohighlight">\(\theta_i\)</span> are
feature weights sampled from a posterior distribution.</p>
<p>The number of trajectories (i.e. batch size) is determined from the first call of the
trajectory. In order to change the batch size, a new <code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryFunction</span></code> must be built.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_functions</strong> – Set of feature function.</p></li>
<li><p><strong>weight_distribution</strong> – Distribution from which feature weights are to be sampled.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.fourier_feature_trajectory.__call__">
<code class="sig-name descname"><span class="pre">__call__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="headerlink" href="#trieste.models.gpflow.fourier_feature_trajectory.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call trajectory function.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.fourier_feature_trajectory.resample">
<code class="sig-name descname"><span class="pre">resample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.fourier_feature_trajectory.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently resample in-place without retracing.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.fourier_feature_trajectory.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_distribution</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow_probability.distributions.MultivariateNormalTriL</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#trieste.models.gpflow.fourier_feature_trajectory.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently update the trajectory with a new weight distribution and resample its weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weight_distribution</strong> – new distribution from which feature weights are to be sampled.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="trieste.models.gpflow.check_optimizer">
<code class="sig-name descname"><span class="pre">check_optimizer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.BatchOptimizer" title="trieste.models.optimizer.BatchOptimizer"><span class="pre">trieste.models.optimizer.BatchOptimizer</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><span class="pre">trieste.models.optimizer.Optimizer</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/utils.html#check_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.check_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the optimizer for the GPflow models is using a correct optimizer wrapper.</p>
<p>Stochastic gradient descent based methods implemented in TensorFlow would not
work properly without mini-batches and hence <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code>
that prepares mini-batches and calls the optimizer iteratively needs to be used. GPflow’s
<code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code> optimizer on the other hand should use the non-batch wrapper
<code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – An instance of the optimizer wrapper with the underlying optimizer.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If <code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code> is not using
<code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code> is
using <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trieste.models.gpflow.randomize_hyperparameters">
<code class="sig-name descname"><span class="pre">randomize_hyperparameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.Module</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/utils.html#randomize_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.randomize_hyperparameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets hyperparameters to random samples from their constrained domains or (if not constraints
are available) their prior distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>object</strong> – Any gpflow Module.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trieste.models.gpflow.squeeze_hyperparameters">
<code class="sig-name descname"><span class="pre">squeeze_hyperparameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="reference internal" href="../../../../_modules/trieste/models/gpflow/utils.html#squeeze_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.squeeze_hyperparameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Squeezes the parameters to be strictly inside their range defined by the Sigmoid,
or strictly greater than the limit defined by the Shift+Softplus.
This avoids having Inf unconstrained values when the parameters are exactly at the boundary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object</strong> – Any gpflow Module.</p></li>
<li><p><strong>alpha</strong> – the proportion of the range with which to squeeze for the Sigmoid case</p></li>
<li><p><strong>epsilon</strong> – the value with which to offset the shift for the Softplus case.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is not in (0,1) or epsilon &lt;= 0</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
    <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright 2020 The Trieste Contributors

Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>